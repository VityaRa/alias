import { Injectable } from '@nestjs/common';
import { ThemeDto, ThemeWithWordsDto, WordDto } from 'src/dto/theme';
import { v4 } from 'uuid';

const defaultWords =
[
  "горный",
  "немыслимый",
  "вырастать",
  "сообщить",
  "искусственный",
  "провинциальный",
  "ресторан",
  "хватить",
  "призывать",
  "различный",
  "искренний",
  "поддержка",
  "наступить",
  "уважать",
  "возникать",
  "лоб",
  "кадровый",
  "добираться",
  "поворот",
  "всеобщий",
  "мысль",
  "тереть",
  "реакция",
  "пользовать",
  "предыдущий",
  "песок",
  "полезть",
  "популярный",
  "связанный",
  "выражаться",
  "открыть",
  "приготавливать",
  "власть",
  "центральный",
  "объект",
  "рамка",
  "звучать",
  "прямой",
  "славянский",
  "применять",
  "сопровождать",
  "страивать",
  "камень",
  "живот",
  "преимущество",
  "мягкий",
  "выходить",
  "добавлять",
  "ответный",
  "конструкция",
  "счастие",
  "прикладной",
  "продолжать",
  "долгий",
  "создаваться",
  "влиять",
  "бледный",
  "случай",
  "произойти",
  "продукт",
  "являть",
  "уникальный",
  "сообщить",
  "посылать",
  "универсальный",
  "обладать",
  "компьютерный",
  "принцип",
  "энергия",
  "трудящийся",
  "регион",
  "поколение",
  "фотография",
  "повернуться",
  "предпринимать",
  "время",
  "террористический",
  "прожить",
  "проведение",
  "сформулировать",
  "потребитель",
  "террористический",
  "уральский",
  "время",
  "возрастать",
  "здравствовать",
  "водный",
  "деятельность",
  "искать",
  "заинтересованный",
  "случайный",
  "социалистический",
  "квартира",
  "колючий",
  "выражение",
  "необычный",
  "войти",
  "несчастный",
  "колено",
  "былой",
  "подписывать",
  "бесплатный",
  "заявить",
  "родитель",
  "общественный",
  "новый",
  "подозревать",
  "пустой",
  "ударный",
  "летний",
  "добиться",
  "почетный",
  "организовать",
  "среда",
  "ворота",
  "привыкать",
  "открыть",
  "тратить",
  "пропасть",
  "привыкнуть",
  "услуга",
  "далекий",
  "свобода",
  "смена",
  "продать",
  "короткий",
  "жирный",
  "опускать",
  "ресурс",
  "внимание",
  "значение",
  "стратегический",
  "прошлое",
  "лейтенант",
  "житель",
  "организовывать",
  "церковь",
  "сбивать",
  "целовать",
  "студенческий",
  "дед",
  "отличие",
  "подготовка",
  "использоваться",
  "социологический",
  "уполномоченный",
  "экономический",
  "партия",
  "учиться",
  "прийтись",
  "садиться",
  "мечта",
  "уважать",
  "инженерный",
  "начальный",
  "сфера",
  "спортивный",
  "структура",
  "генерал",
  "ведомство",
  "участвовать",
  "скрытый",
  "ранний",
  "ледяной",
  "истинный",
  "хозяйство",
  "ориентированный",
  "приближать",
  "вспоминать",
  "довольный",
  "скрывать",
  "скрывать",
  "потерпеть",
  "читать",
  "гениальный",
  "отличаться",
  "способствовать",
  "отношение",
  "шутка",
  "входить",
  "мощный",
  "щека",
  "миллион",
  "понимать",
  "этнический",
  "пиво",
  "ломать",
  "субъективный",
  "переход",
  "познакомиться",
  "концерт",
  "глухой",
  "проводиться",
  "господин",
  "фраза",
  "проблема",
  "предстоящий",
  "предложить",
  "частный",
  "нормальный",
  "пытаться",
  "ребенок",
  "местный",
  "возвращение",
  "господь",
  "лагерь",
  "областной",
  "банальный",
  "командовать",
  "линейный",
  "кавказский",
  "несчастный",
  "божественный",
  "образоваться",
  "украсть",
  "редкий",
  "тянуть",
  "администрация",
  "специфический",
  "престижный",
  "страна",
  "род",
  "читать",
  "предпочитать",
  "орган",
  "допускать",
  "грязный",
  "сад",
  "ощущать",
  "достать",
  "сцена",
  "рынок",
  "предпочитать",
  "показываться",
  "радоваться",
  "считать",
  "окончание",
  "корреспондент",
  "указать",
  "водка",
  "острый",
  "украинский",
  "известие",
  "махнуть",
  "шум",
  "борьба",
  "нефтяной",
  "ограничивать",
  "понимать",
  "прекращать",
  "успеть",
  "церковный",
  "армейский",
  "постоять",
  "содержание",
  "порождать",
  "сообщить",
  "верховный",
  "литературный",
  "перестать",
  "музей",
  "величина",
  "крепкий",
  "просить",
  "лодка",
  "лишать",
  "увеличение",
  "сломать",
  "психологический",
  "строиться",
  "лишенный",
  "загадочный",
  "вечер",
  "вершина",
  "существование",
  "ключевой",
  "индийский",
  "поддерживать",
  "центральный",
  "ответить",
  "штат",
  "дело",
  "незнакомый",
  "храм",
  "отправляться",
  "радикальный",
  "корреспондент",
  "готовиться",
  "вернуть",
  "сладкий",
  "ограничивать",
  "общий",
  "замолчать",
  "майор",
  "свобода",
  "немец",
  "разобраться",
  "грустный",
  "многие",
  "апрель",
  "нога",
  "студент",
  "чемпионат",
  "организовывать",
  "оплачивать",
  "творческий",
  "занятие",
  "поверхность",
  "сознательный",
  "сознательный",
  "муниципальный",
  "вестись",
  "фактический",
  "финансирование",
  "распределение",
  "пространство",
  "сталкиваться",
  "сотня",
  "начаться",
  "регистрация",
  "иркутский",
  "политический",
  "родиться",
  "добавлять",
  "общение",
  "бросать",
  "потенциальный",
  "спорт",
  "оказывать",
  "обернуться",
  "законодательство",
  "попадать",
  "трава",
  "дать",
  "свидетель",
  "активность",
  "излагать",
  "взрыв",
  "пропускать",
  "размышлять",
  "контакт",
  "испанский",
  "женский",
  "повторять",
  "газетный",
  "официальный",
  "переход",
  "подбирать",
  "мама",
  "полюбить",
  "атомный",
  "товар",
  "наблюдение",
  "рабочий",
  "класс",
  "любой",
  "вытащить",
  "мечта",
  "название",
  "встречаться",
  "выполнение",
  "москвич",
  "настроение",
  "короткий",
  "предупредить",
  "задний",
  "коммунальный",
  "сохраниться",
  "еврейский",
  "свидетель",
  "особый",
  "приходиться",
  "летать",
  "явление",
  "передать",
  "берег",
  "кадровый",
  "рубль",
  "окружать",
  "улыбка",
  "благодарить",
  "воскликнуть",
  "корреспондент",
  "неизменный",
  "произведение",
  "указывать",
  "географический",
  "прохожий",
  "роковой",
  "везти",
  "академия",
  "зависимость",
  "противник",
  "называться",
  "набор",
  "стабильный",
  "федерация",
  "здоровье",
  "хватать",
  "приезжать",
  "символический",
  "функция",
  "подготовка",
  "судебный",
  "среда",
  "ужас",
  "планироваться",
  "кричать",
  "результат",
  "организм",
  "московский",
  "протянуть",
  "одежда",
  "положительный",
  "чемпионат",
  "герой",
  "событие",
  "спуститься",
  "таинственный",
  "планироваться",
  "ручка",
  "администрация",
  "психология",
  "попробовать",
  "предыдущий",
  "заговорить",
  "смочь",
  "ночной",
  "фотография",
  "непростой",
  "ставить",
  "пушкинский",
  "поселок",
  "непонятный",
  "схема",
  "пытаться",
  "перечислять",
  "боль",
  "возвращение",
  "мужик",
  "опытный",
  "течение",
  "мужик",
  "перевод",
  "садиться",
  "отправлять",
  "поэтический",
  "старинный",
  "слабый",
  "агентство",
  "таблица",
  "напряженный",
  "час",
  "транспортный",
  "будущее",
  "машина",
  "сохраняться",
  "строгий",
  "конец",
  "волшебный",
  "встречаться",
  "пользоваться",
  "контракт",
  "художник",
  "поверхность",
  "выявлять",
  "предлагать",
  "замкнутый",
  "добавить",
  "освобождать",
  "небо",
  "убирать",
  "прийтись",
  "чиновник",
  "управление",
  "вынужденный",
  "питерский",
  "далекий",
  "зритель",
  "продать",
  "выпивать",
  "оформлять",
  "количество",
  "священный",
  "спортивный",
  "внезапный",
  "шахматный",
  "укладывать",
  "пугать",
  "спрашивать",
  "вскочить",
  "крыло",
  "оглянуться",
  "революционный",
  "уметь",
  "встретиться",
  "смена",
  "раздражать",
  "производство",
  "роскошный",
  "носить",
  "камень",
  "разрабатывать",
  "мера",
  "живот",
  "праздник",
  "ближний",
  "запасной",
  "явление",
  "услышать",
  "ненавидеть",
  "образ",
  "начинаться",
  "капитал",
  "разумный",
  "приятный",
  "дерево",
  "придавать",
  "руководить",
  "чувство",
  "концепция",
  "царский",
  "зона",
  "стоить",
  "обучение",
  "исходный",
  "интересный",
  "обращаться",
  "прекращать",
  "доклад",
  "передача",
  "подавлять",
  "поделиться",
  "продавать",
  "планировать",
  "поворачиваться",
  "присутствие",
  "самостоятельный",
  "образоваться",
  "задуматься",
  "обеспечивать",
  "день",
  "сойти",
  "собирать",
  "радовать",
  "юридический",
  "надевать",
  "лошадь",
  "минимальный",
  "конференция",
  "гениальный",
  "жилой",
  "обходиться",
  "найти",
  "синий",
  "канал",
  "вес",
  "прекращать",
  "живот",
  "ответственность",
  "боль",
  "одевать",
  "доллар",
  "начальный",
  "справедливый",
  "нравиться",
  "пожалеть",
  "фамилия",
  "невинный",
  "прием",
  "составлять",
  "крикнуть",
  "купить",
  "описание",
  "иной",
  "акция",
  "добираться",
  "дверь",
  "великолепный",
  "начаться",
  "подъезд",
  "привозить",
  "оборона",
  "вспоминать",
  "кончаться",
  "пространство",
  "судебный",
  "услышать",
  "директор",
  "везти",
  "американец",
  "имя",
  "скрытый",
  "проклятый",
  "срок",
  "функция",
  "обязанный",
  "плоский",
  "геологический",
  "познакомиться",
  "окружать",
  "занятие",
  "потребоваться",
  "заслуживать",
  "мировой",
  "гражданский",
  "уступать",
  "переговоры",
  "отпустить",
  "кровать",
  "любовный",
  "звонить",
  "сложный",
  "постель",
  "сознательный",
  "секретный",
  "ленинградский",
  "устройство",
  "изображение",
  "разговаривать",
  "секретный",
  "жизнь",
  "украшать",
  "просьба",
  "законодательный",
  "блаженный",
  "подписать",
  "жесткий",
  "шея",
  "структурный",
  "эксперимент",
  "расчет",
  "живот",
  "сказка",
  "капитальный",
  "рыбный",
  "виновный",
  "вина",
  "поворот",
  "возможный",
  "пермский",
  "неподвижный",
  "безопасный",
  "служебный",
  "власть",
  "окончание",
  "магазин",
  "контроль",
  "раскрывать",
  "половина",
  "прикладной",
  "священный",
  "живот",
  "волноваться",
  "соглашаться",
  "длинный",
  "кадровый",
  "контакт",
  "комплексный",
  "политика",
  "честь",
  "последний",
  "образованный",
  "погибнуть",
  "противоречить",
  "лагерь",
  "высокий",
  "обычный",
  "спортивный",
  "образец",
  "любовный",
  "показать",
  "ресторан",
  "увеличивать",
  "понятный",
  "торчать",
  "профессия",
  "прикладной",
  "спросить",
  "противоположный",
  "вызывать",
  "запах",
  "государство",
  "необходимость",
  "территория",
  "радовать",
  "полковник",
  "собираться",
  "вопрос",
  "род",
  "долгосрочный",
  "признаться",
  "привозить",
  "громкий",
  "понимание",
  "недостаточный",
  "ровный",
  "подводной",
  "школьный",
  "суметь",
  "мощный",
  "добиться",
  "психологический",
  "опыт",
  "сентябрь",
  "идеальный",
  "кодекс",
  "ситуация",
  "уйти",
  "поделиться",
  "бумага",
  "выражаться",
  "горло",
  "модный",
  "деревянный",
  "благоприятный",
  "договориться",
  "убить",
  "организовывать",
  "возвращение",
  "кольцо",
  "наружный",
  "село",
  "буржуазный",
  "неприятный",
  "переставать",
  "входить",
  "польза",
  "помещение",
  "союз",
  "выходить",
  "божий",
  "результат",
  "завод",
  "захотеться",
  "вирусный",
  "данный",
  "заканчиваться",
  "шутка",
  "разговаривать",
  "экран",
  "обращение",
  "делаться",
  "официальный",
  "партия",
  "традиция",
  "проявляться",
  "пакет",
  "обнаруживать",
  "имя",
  "добавить",
  "коренной",
  "совпадать",
  "обозначать",
  "красивый",
  "алюминиевый",
  "данный",
  "вкусный",
  "подразделение",
  "построить",
  "призванный",
  "закрывать",
  "руководство",
  "похожий",
  "входной",
  "первоначальный",
  "мечтать",
  "ударный",
  "заявление",
  "энергия",
  "труба",
  "милицейский",
  "трогать",
  "множество",
  "человеческий",
  "изготовлять",
  "являться",
  "эффективный",
  "разрабатывать",
  "независимый",
  "превращать",
  "многолетний",
  "администрация",
  "незнакомый",
  "держать",
  "глубина",
  "схватить",
  "разработка",
  "проводить",
  "поступить",
  "игра",
  "несчастный",
  "нарисовать",
  "жестокий",
  "философия",
  "сад",
  "крупный",
  "расстояние",
  "исполнять",
  "старинный",
  "захотеться",
  "текст",
  "твердый",
  "билет",
  "бесконечный",
  "товарный",
  "оценка",
  "прекрасный",
  "озабоченный",
  "потянуть",
  "кулак",
  "искусственный",
  "дорогой",
  "трезвый",
  "жилой",
  "ряд",
  "вид",
  "сбор",
  "допустить",
  "выражаться",
  "временить",
  "заявление",
  "улыбка",
  "неподвижный",
  "пожалеть",
  "атмосфера",
  "почтовый",
  "голый",
  "волшебный",
  "телефонный",
  "решиться",
  "царь",
  "свобода",
  "район",
  "двор",
  "необыкновенный",
  "годовой",
  "утверждать",
  "выбор",
  "курс",
  "отменять",
  "летать",
  "благоприятный",
  "испытание",
  "встречный",
  "школьный",
  "приехать",
  "губа",
  "лесной",
  "билет",
  "кость",
  "проговорить",
  "статус",
  "успеть",
  "заглянуть",
  "счет",
  "анализ",
  "бюджетный",
  "алюминиевый",
  "линия",
  "сотрудничество",
  "напоминать",
  "банальный",
  "попасть",
  "подход",
  "часовой",
  "вспоминать",
  "монастырь",
  "деревенский",
  "продукт",
  "висеть",
  "неизменный",
  "контрольный",
  "научиться",
  "отводить",
  "порядок",
  "базовый",
  "проявляться",
  "израильский",
  "организовать",
  "избегать",
  "десяток",
  "начальный",
  "объединение",
  "величина",
  "гнать",
  "трезвый",
  "университет",
  "фон",
  "уральский",
  "куст",
  "объект",
  "немой",
  "рассматриваться",
  "объявлять",
  "резиновый",
  "согласный",
  "агрессивный",
  "бросать",
  "кадр",
  "мокрый",
  "широкий",
  "задумываться",
  "очищать",
  "собрание",
  "черт",
  "избирать",
  "задний",
  "инструмент",
  "сотня",
  "властный",
  "мудрый",
  "укреплять",
  "отчаянный",
  "фактический",
  "импортный",
  "наблюдаться",
  "дверь",
  "быль",
  "прочесть",
  "позволить",
  "специалист",
  "выдерживать",
  "студенческий",
  "привыкать",
  "беспокоить",
  "подозрительный",
  "подъезд",
  "строиться",
  "прыгать",
  "привычный",
  "убежденный",
  "финансовый",
  "финансовый",
  "огромный",
  "состояться",
  "способствовать",
  "телефонный",
  "гуманитарный",
  "деньга",
  "распределение",
  "степень",
  "семь",
  "менять",
  "территория",
  "рассматриваться",
  "рассчитывать",
  "приглашать",
  "печатный",
  "давить",
  "лунный",
  "легкий",
  "лес",
  "встречаться",
  "бутылка",
  "административный",
  "порождать",
  "порядочный",
  "зайти",
  "оценка",
  "отказываться",
  "моральный",
  "очередь",
  "уровень",
  "поэзия",
  "нож",
  "поинтересоваться",
  "потребитель",
  "канал",
  "соответствие",
  "заниматься",
  "ставка",
  "забрать",
  "превратиться",
  "описывать",
  "честной",
  "вредный",
  "характерный",
  "церковный",
  "охранять",
  "гигантский",
  "научнотехнический",
  "сфера",
  "уважаемый",
  "лидер",
  "драгоценный",
  "успокаивать",
  "земля",
  "теория",
  "рассказ",
  "патриотический",
  "вступить",
  "фирма",
  "полететь",
  "использоваться",
  "оружие",
  "город",
  "перечислять",
  "рассчитывать",
  "партия"
];

const hardWords = [
  "Агент",
  "Баба",
  "Бордо",
  "Канализация",
  "Зелье",
  "Бакен",
  "Тальк",
  "Одеколон",
  "Контейнер",
  "Крага",
  "Канделябр",
  "Горох",
  "Кишка",
  "Абаз",
  "Каньон",
  "Покрывало",
  "Олово",
  "Врата",
  "Баранина",
  "Сазан",
  "Вельможа",
  "Вуз",
  "Диспансер",
  "Шланг",
  "Сейф",
  "Автострада",
  "Касательство",
  "Куница",
  "Лабиринт",
  "Температура",
  "Кавалер",
  "Жилище",
  "Кафель",
  "Петербург",
  "Зубец",
  "Кружево",
  "Вареник",
  "Картошка",
  "Вентиляция",
  "Боинг",
  "Лезвие",
  "Карат",
  "Гравий",
  "Киноактер",
  "Корпус",
  "Плацента",
  "Жезл",
  "Загон",
  "Кобыла",
  "Лямка",
  "Квашня",
  "Аспид",
  "Голландия",
  "Каракуля",
  "Автовесы",
  "Бабка",
  "Желудок",
  "Кинозвезда",
  "Лохмотья",
  "Забор",
  "Ловушка",
  "Плитка",
  "Газета",
  "Хижина",
  "Чемодан",
  "Камаз",
  "Кувшинка",
  "Ксерокс",
  "Антибиотик",
  "Акварель",
  "Лупа",
  "Задворки",
  "Лодка",
  "Аэродром",
  "Китель",
  "Окно",
  "Кухарка",
  "Жаба",
  "Эдельвейс",
  "Блесна",
  "Кий",
  "Дух",
  "Баланда",
  "Ковчег",
  "Племя",
  "Умывальник",
  "Парковка",
  "Корешок",
  "Гадюка",
  "Биополе",
  "Кордон",
  "Мокасин",
  "Краситель",
  "Кона",
  "Стрела",
  "Волкодав",
  "Шлем",
  "Синица",
  "Огород",
  "Цифра",
  "Жгут",
  "Кино",
  "Коктейль",
  "Бюллетень",
  "Экскаватор",
  "Кухонька",
  "Глаз",
  "Контрабанда",
  "Тетрадь",
  "Палата",
  "Зубило",
  "Кит",
  "Клизма",
  "Артемида",
  "Автохром",
  "Шелк",
  "Жид",
  "Картахена",
  "Лицей",
  "Почта",
  "Дерматин",
  "Локоть",
  "Шпала",
  "Иллюминатор",
  "Массажист",
  "Феодал",
  "Электричка",
  "Зодиак",
  "Винтовка",
  "Клен",
  "Кочерга",
  "Гитара",
  "Журнал",
  "Слепок",
  "Пасть",
  "Дот",
  "Мученик",
  "Бухта",
  "Амортизатор",
  "Белоруссия",
  "Африканец",
  "Слива",
  "Венгр",
  "Щель",
  "Лифт",
  "Заря",
  "Атаман",
  "Чулок",
  "Оптика",
  "Аденоид",
  "Копейка",
  "Парламент",
  "Овечка",
  "Консервы",
  "Сито",
  "Болт",
  "Волна",
  "Маслозавод",
  "Здание",
  "Муляж",
  "Подушка",
  "Компот",
  "Бензоколонка",
  "Выпечка",
  "Мишень",
  "Полотно",
  "Пудра",
  "Строка",
  "Асбест",
  "Марокко",
  "Атлетика",
  "Голгофа",
  "Библиотекарша",
  "Эмаль",
  "Карга",
  "Морщина",
  "Бегемот",
  "Защелка",
  "Розетка",
  "Базар",
  "Ракета",
  "Слеза",
  "Марганец",
  "Качалка",
  "Мыльница",
  "Корм",
  "Питомник",
  "Аксельбант",
  "Аферист",
  "Леопард",
  "Лесоруб",
  "Ущелье",
  "Банк",
  "Козерог",
  "Волгоград",
  "Авиазавод",
  "Катапульта",
  "Молотилка",
  "Фрукт",
  "Парус",
]



@Injectable()
export class ThemeRepository {
  themes: ThemeWithWordsDto[];
  constructor() {
    this.themes = [];
    const easyWordsWithIds = defaultWords.map((w) => ({value: w, id: v4()}));
    const hardWordsWithIds = hardWords.map((w) => ({value: w, id: v4()}));
    const easy: ThemeWithWordsDto = {
      id: v4(),
      title: 'Обычный',
      words: easyWordsWithIds,
    };
    const hard: ThemeWithWordsDto = {
      id: v4(),
      title: 'Трудный',
      words: hardWordsWithIds,
    };
    this.themes.push(easy);
    this.themes.push(hard);
  }

  getLabels() {
    return this.themes.map(({ words, ...rest }) => rest);
  }

  getNextWordTheme(themeId: string, usedWords?: string[]) {
    const theme = this.themes.find((t) => t.id === themeId);
    const notUsedWords = theme.words.filter((w) => !usedWords.includes(w.id));
    const shuffled = this.shuffleWords(notUsedWords);
    return shuffled[0];
  }

  private shuffleWords(array: WordDto[]) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  getById(id: string) {
    return this.themes.find((t) => t.id === id);
  }

  toDto(themeId: string, ids: string[]) {
    const theme = this.getById(themeId);
    return ids.map((id) => {
      return theme.words.find((w) => w.id === id);
    })
  }
}

